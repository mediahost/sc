(function(b,c,d){if(typeof c!="function"){return console.error("nette.ajax.js: jQuery is missing, load it please")}var a=function(){var e={self:this,initialized:false,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var f=true;var h=Array.prototype.slice.call(arguments);var i=h.shift();var g=(typeof i=="string")?i:i.name;var j=(typeof i=="object")?i.off||{}:{};h.push(e.self);c.each(e.on[g],function(l,m){if(m===d||c.inArray(l,j)!==-1){return true}var k=m.apply(e.contexts[l],h);return f=(k===d||k)});return f},requestHandler:function(f){if(!e.self.ajax({},this,f)){return}},ext:function(h,g,f){while(!f){f="ext_"+Math.random();if(e.contexts[f]){f=d}}c.each(h,function(i,j){e.on[i][f]=j});e.contexts[f]=c.extend(g?g:{},{name:function(){return f},ext:function(i,k){var j=e.contexts[i];if(!j&&k){throw"Extension '"+this.name()+"' depends on disabled extension '"+i+"'."}return j}})}};this.ext=function(f,h,g){if(typeof f=="object"){e.ext(f,h)}else{if(h===d){return e.contexts[f]}else{if(!h){c.each(["init","load","prepare","before","start","success","complete","error"],function(i,j){e.on[j][f]=d});e.contexts[f]=d}else{if(typeof f=="string"&&e.contexts[f]!==d){throw"Cannot override already registered nette-ajax extension '"+f+"'."}else{e.ext(h,g,f)}}}}return this};this.init=function(g,f){if(e.initialized){throw"Cannot initialize nette-ajax twice."}if(typeof g=="function"){this.ext("init",null);this.ext("init",{load:g},f)}else{if(typeof g=="object"){this.ext("init",null);this.ext("init",g,f)}else{if(g!==d){throw"Argument of init() can be function or function-hash only."}}}e.initialized=true;e.fire("init");this.load();return this};this.load=function(){e.fire("load",e.requestHandler);return this};this.ajax=function(h,i,j){if(!h.nette&&i&&j){var f=c(i),l,k;var g=h.nette={e:j,ui:i,el:f,isForm:f.is("form"),isSubmit:f.is("input[type=submit]")||f.is("button[type=submit]"),isImage:f.is("input[type=image]"),form:null};if(g.isSubmit||g.isImage){g.form=g.el.closest("form")}else{if(g.isForm){g.form=g.el}}if(!h.url){h.url=g.form?g.form.attr("action"):i.href}if(!h.type){h.type=g.form?g.form.attr("method"):"get"}if(f.is("[data-ajax-off]")){h.off=f.data("ajaxOff");if(typeof h.off=="string"){h.off=[h.off]}}}e.fire({name:"prepare",off:h.off||{}},h);if(h.prepare){h.prepare(h)}k=h.beforeSend;h.beforeSend=function(o,n){if(k){var m=k(o,n);if(m!==d&&!m){return m}}return e.fire({name:"before",off:n.off||{}},o,n)};if(typeof Pace!=="undefined"){l=Pace.track(function(){return c.ajax(h)})}else{l=c.ajax(h)}if(l&&(typeof l.statusText==="undefined"||l.statusText!=="canceled")){l.done(function(n,m,o){e.fire({name:"success",off:h.off||{}},n,m,o)}).fail(function(o,m,n){e.fire({name:"error",off:h.off||{}},o,m,n)}).always(function(n,m){e.fire({name:"complete",off:h.off||{}},n,m)});e.fire({name:"start",off:h.off||{}},l,h);if(h.start){h.start(l,h)}}return l}};c.nette=new (c.extend(a,c.nette?c.nette:{}));c.fn.netteAjax=function(g,f){return c.nette.ajax(f||{},this[0],g)};c.fn.netteAjaxOff=function(){return this.off(".nette")};c.nette.ext("validation",{before:function(l,i){if(!i.nette){return true}else{var h=i.nette}var j=h.e;var k=c.extend({keys:true,url:true,form:true},i.validate||(function(){if(!h.el.is("[data-ajax-validate]")){return}var e=h.el.data("ajaxValidate");if(e===false){return{keys:false,url:false,form:false}}else{if(typeof e=="object"){return e}}})()||{});var f=false;if(h.el.attr("data-ajax-pass")!==d){f=h.el.data("ajaxPass");f=typeof f=="bool"?f:true}if(k.keys){var g=j.button||j.ctrlKey||j.shiftKey||j.altKey||j.metaKey;if(h.form){if(g&&h.isSubmit){this.explicitNoAjax=true;return false}else{if(h.isForm&&this.explicitNoAjax){this.explicitNoAjax=false;return false}}}else{if(g){return false}}}if(k.form&&h.form&&!((h.isSubmit||h.isImage)&&h.el.attr("formnovalidate")!==d)){if(h.form.get(0).onsubmit&&h.form.get(0).onsubmit()===false){j.stopImmediatePropagation();j.preventDefault();return false}}if(k.url){if(/:|^#/.test(h.form?i.url:h.el.attr("href"))){return false}}if(!f){j.stopPropagation();j.preventDefault()}return true}},{explicitNoAjax:false});c.nette.ext("forms",{init:function(){var e;if(!b.Nette||!(e=this.ext("snippets"))){return}e.after(function(f){f.find("form").each(function(){b.Nette.initForm(this)})})},prepare:function(i){var h=i.nette;if(!h||!h.form){return}var l=h.e;var j=i.data||{};var k={};if(h.isSubmit){k[h.el.attr("name")]=h.el.val()||""}else{if(h.isImage){var m=h.el.offset();var g=h.el.attr("name");var f=[Math.max(0,l.pageX-m.left),Math.max(0,l.pageY-m.top)];if(g.indexOf("[",0)!==-1){k[g]=f}else{k[g+".x"]=f[0];k[g+".y"]=f[1]}}}if(typeof j!="string"){j=c.param(j)}k=c.param(k);i.data=h.form.serialize()+(k?"&"+k:"")+"&"+j}});c.nette.ext("snippets",{success:function(h){var g=[];if(h.snippets){for(var f in h.snippets){var e=this.getElement(f);c.each(this.beforeQueue,function(i,j){if(typeof j=="function"){j(e)}});this.updateSnippet(e,h.snippets[f]);c.each(this.afterQueue,function(i,j){if(typeof j=="function"){j(e)}})}}this.before(g)}},{beforeQueue:[],afterQueue:[],before:function(e){this.beforeQueue.push(e)},after:function(e){this.afterQueue.push(e)},updateSnippet:function(g,f,e){if(typeof g=="string"){g=this.getElement(g)}if(g.is("title")){document.title=f}else{this.applySnippet(g,f,e)}},getElement:function(e){return c("#"+this.escapeSelector(e))},applySnippet:function(g,f,e){if(!e&&g.is("[data-ajax-append]")){g.append(f)}else{g.html(f)}},escapeSelector:function(e){return e.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}});c.nette.ext("redirect",{success:function(e){if(e.redirect){b.location.href=e.redirect;return false}}});c.nette.ext("state",{success:function(e){if(e.state){this.state=e.state}}},{state:null});c.nette.ext("unique",{start:function(e){if(this.xhr){this.xhr.abort()}this.xhr=e},complete:function(){this.xhr=null}},{xhr:null});c.nette.ext("abort",{init:function(){c("body").keydown(c.proxy(function(f){if(this.xhr&&(f.keyCode==27&&!(f.ctrlKey||f.shiftKey||f.altKey||f.metaKey))){this.xhr.abort()}},this))},start:function(e){this.xhr=e},complete:function(){this.xhr=null}},{xhr:null});c.nette.ext("load",{success:function(){c.nette.load()}});c.nette.ext("init",{load:function(e){c(this.linkSelector).off("click.nette",e).on("click.nette",e);c(this.formSelector).off("submit.nette",e).on("submit.nette",e).off("click.nette",":image",e).on("click.nette",":image",e).off("click.nette",":submit",e).on("click.nette",":submit",e);c(this.buttonSelector).closest("form").off("click.nette",this.buttonSelector,e).on("click.nette",this.buttonSelector,e)}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]'})})(window,window.jQuery);